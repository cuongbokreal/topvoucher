
<html>
  <head>
    <meta charset='UTF-8'/>
    <meta content='width=device-width, initial-scale=1, user-scalable=1, minimum-scale=1, maximum-scale=5' name='viewport'/>
    <meta content='IE=edge' http-equiv='X-UA-Compatible'/>
    <title>Tạo Deeplink</title>
  </head>
  <body>
    <div id="main">
        <p>Id CTV: <span class="text-danger" id="ctv_id"></span></p>
        <h4>Reg All TMDT</h4>
        <input id="linkSp" placeholder="Nhập link" onblur="createDeeplink()" onclick="this.select()"/>
      <p id="thbao"></p>
        <button class="button" id="btnDeplink" onclick="createDeeplink()">Tạo</button>
        <textarea id="kqDeeplink" placeholder="Kết quả" onclick="this.select()"></textarea>
      
      <p id="refreshFrame">Làm mới</p>
      <div id="iframeShort">
        <iframe scrolling="no" id="short" src="https://bitly.com.vn/#short" ></iframe>
      </div>
      <!-- https://bom.so/#main-form -->
      
        <div id="infor_camp"></div>
        </div>
    <div>
      
    <script>
      var getUrlParameter = function getUrlParameter(sParam) {
      var sPageURL = window.location.search.substring(1), sURLVariables = sPageURL.split('&'), sParameterName, i;
      for (i = 0; i < sURLVariables.length; i++) {
          sParameterName = sURLVariables[i].split('=');
          if (sParameterName[0] === sParam) {
              return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
          }
      }
  };
      var ctv_id = getUrlParameter('id');
      if (ctv_id[0].length >= 6){
        document.getElementById('ctv_id').innerHTML = ctv_id[0];
      }
      
      var source = `&utm_source=ctv&utm_medium=ctv_${ctv_id[0]}&utm_campaign=${window.location.href}&utm_content=createDeepLink`;
      
      const deeplink = 'https://go.isclix.com/deep_link/5353514789844343379';
      var btnDeplink = document.getElementById('btnDeplink');
      var kqDeeplink = document.getElementById('kqDeeplink');
      var infor_camp = document.getElementById('infor_camp');
      var data_ad = [
        {"name":"Shopee",
         "reg":"shopee",
         "camp_id":"4751584435713464237"
        },
        {"name":"Lazada",
         "reg":"lazada",
         "camp_id":"5087153089503673507"
        },
        {"name":"Tiki",
         "reg":"tiki",
         "camp_id":"4348614231480407268"
        },
      ]
      var kq = '';
      var data_infor_camp = '';
      function createDeeplink(){
        var linkSp = document.getElementById('linkSp');
        if(linkSp.value.match(/shopee\.vn/g)){
          kq = `${deeplink}/${data_ad[0].camp_id}?url=${linkSp.value}${source}`;
          data_infor_camp = `<p>Tên camp: <span style="color:red">${data_ad[0].name}</span></p> 
                             <p>Link gốc: <span style="color:red">${linkSp.value}</span></p> 
                             <p>Tracking link: <span style="color:red">${kq}</span></p>`;
        } else
        if(linkSp.value.match(/lazada\.vn/g)){
          kq = `${deeplink}/${data_ad[1].camp_id}?url=${linkSp.value}${source}`;
          data_infor_camp = `<p>Tên camp: <span style="color:red">${data_ad[1].name}</span></p> 
                             <p>Link gốc: <span style="color:red">${linkSp.value}</span></p> 
                             <p>Tracking link: <span style="color:red">${kq}</span></p>`;
        } else
        if(linkSp.value.match(/tiki\.vn/g)){
          kq = `${deeplink}/${data_ad[2].camp_id}?url=${linkSp.value}${source}`;
          data_infor_camp = `<p>Tên camp: <span style="color:red">${data_ad[2].name}</span></p> 
                             <p>Link gốc: <span style="color:red">${linkSp.value}</span></p> 
                             <p>Tracking link: <span style="color:red">${kq}</span></p>`;
        } else{document.getElementById('thbao').innerHTML = 'Link sai hoặc lỗi camp';}
        kqDeeplink.value = kq;
        infor_camp.innerHTML = data_infor_camp;
      }
      
      document.getElementById('refreshFrame').addEventListener("click", function(){
        //document.getElementById('short').contentWindow.location.reload();
        document.getElementById('short').src = '';
        document.getElementById('short').src = 'https://bitly.com.vn/#short';
      })
    </script>
    <style>
      #main{padding:10px}
      input {font-family: "Roboto", sans-serif;outline: 0;background: #f2f2f2;width: 100%;height:80px;border: 0;margin: 10 0 35px;padding: 15px;box-sizing: border-box;font-size: 14px;}
      .button {font-family: "Roboto", sans-serif;text-transform: uppercase;outline: 0;background: #4CAF50;border: 1px solid #f44296;width: 100%;padding: 15px;color: #FFFFFF;font-size: 14px;-webkit-transition: all 0.3 ease;transition: all 0.3 ease;cursor: pointer;}
      .button:hover,.button:active,.button:focus {background: #43A047;}
      .button:hover {box-shadow: 0 12px 16px 0 rgba(0,0,0,0.09), 0 17px 50px 0 rgba(0,0,0,0.09);}  
      textarea{width:100%;height:60px;margin-top:10px;background: #f2f2f2;border: 0;}
      .text-danger, .text-red {color: #e55039!important;}
      
      #refreshFrame{cursor:pointer; margin-top:10px;}
      #iframeShort{margin-top:10px; border: 1px solid #cecece;margin-top: 5px;}
      #short{width:100%;height: 25%; border: 0; overflow: hidden;}
      #infor_camp{line-break: anywhere;}
      
      @media screen and (max-width:640px){}
    </style>
  </body>
</html>
